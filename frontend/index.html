<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help Johanna Get to Tanzania - Mission Trip Fundraiser</title>
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' https://script.google.com; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700;800&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #1E5AA8;
            --secondary: #1D8A3F;
            --accent: #FCD20F;
            --dark: #2c3e50;
            --light: #f8f9fa;
            --danger: #e74c3c;
            --success: #27ae60;
            --text: #333333;
            --text-light: #777777;
            --card-bg: rgba(255, 255, 255, 0.95);
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            background: linear-gradient(135deg, #1E5AA8 0%, #1D8A3F 100%);
            min-height: 100vh;
            color: var(--text);
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" viewBox="0 0 200 200"><path d="M0,0 C0,0 100,50 100,100 C100,150 200,200 200,200 L0,200 Z" fill="rgba(252, 210, 15, 0.1)"/></svg>');
            background-size: cover;
            opacity: 0.3;
            z-index: -1;
        }

        .container {
            width: 100%;
            max-width: 1000px;
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.15);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(31, 38, 135, 0.3);
            position: relative;
            overflow: hidden;
        }

        .container::before {
            content: "";
            position: absolute;
            top: -50%;
            right: -50px;
            width: 200px;
            height: 200px;
            background: var(--accent);
            border-radius: 50%;
            opacity: 0.1;
            z-index: -1;
        }

        .header {
            text-align: center;
            padding: 40px 30px;
            background: var(--card-bg);
            border-radius: 20px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
            border-bottom: 5px solid var(--accent);
        }

        .header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .header h1 {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.8em;
            color: var(--primary);
            font-weight: 800;
            margin-bottom: 10px;
            position: relative;
            display: inline-block;
        }

        .header h1::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--accent);
            border-radius: 2px;
        }

        .header h2 {
            font-size: 1.5em;
            color: var(--secondary);
            font-weight: 600;
            margin: 20px 0;
        }

        .header .trip-dates {
            display: inline-block;
            background: var(--accent);
            color: var(--dark);
            padding: 8px 20px;
            border-radius: 30px;
            font-weight: 600;
            margin-top: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }

        .mission-info {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
            border-left: 5px solid var(--primary);
        }

        .mission-info h3 {
            color: var(--primary);
            font-family: 'Montserrat', sans-serif;
            font-size: 1.6em;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mission-info h3 i {
            color: var(--accent);
        }

        .mission-info p {
            margin-bottom: 15px;
            line-height: 1.7;
        }

        .mission-info ul {
            padding-left: 25px;
            margin: 20px 0;
        }

        .mission-info li {
            margin-bottom: 10px;
            position: relative;
        }

        .mission-info li::before {
            content: "â€¢";
            color: var(--accent);
            font-weight: bold;
            position: absolute;
            left: -20px;
        }

        .mission-highlight {
            background: linear-gradient(135deg, rgba(252, 210, 15, 0.15), rgba(30, 90, 168, 0.15));
            padding: 25px;
            border-radius: 15px;
            margin-top: 25px;
            border-left: 4px solid var(--accent);
        }

        .mission-highlight strong {
            color: var(--primary);
        }

        .admin-panel, .fundraiser-card, .donation-summary, .auth-form {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: var(--shadow);
        }

        .admin-toggle {
            background: linear-gradient(45deg, var(--primary), #3a7cbb);
            color: white;
            padding: 14px 30px;
            border: none;
            border-radius: 30px;
            font-size: 1.1em;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 0 auto;
        }

        .admin-toggle:hover {
            background: linear-gradient(45deg, #2a6bc4, #4d9ae0);
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .admin-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            font-weight: 600;
            margin-bottom: 8px;
            display: block;
            color: var(--primary);
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 1em;
            transition: var(--transition);
            font-family: 'Open Sans', sans-serif;
        }

        .form-group input:focus, .form-group textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 90, 168, 0.2);
            outline: none;
        }

        .fundraiser-card {
            position: relative;
            overflow: hidden;
        }

        .fundraiser-card.completed {
            background: linear-gradient(135deg, var(--success), #2ecc71);
            color: white;
        }

        .fundraiser-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .fundraiser-name {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.2em;
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 15px;
        }

        .fundraiser-bio {
            color: var(--text);
            font-size: 1.1em;
            line-height: 1.7;
            max-width: 700px;
            margin: 0 auto;
            background: rgba(252, 210, 15, 0.1);
            padding: 20px;
            border-radius: 15px;
            border-left: 4px solid var(--accent);
        }

        .progress-section {
            background: rgba(30, 90, 168, 0.05);
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .progress-text {
            font-weight: 600;
            color: var(--primary);
            font-size: 1.1em;
        }

        .progress-percentage {
            font-weight: 700;
            color: var(--secondary);
            font-size: 1.2em;
        }

        .progress-bar {
            background: #e0e0e0;
            border-radius: 20px;
            overflow: hidden;
            height: 24px;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .progress-fill {
            height: 100%;
            width: 0%;
            background: linear-gradient(to right, var(--accent), var(--secondary));
            transition: width 0.6s cubic-bezier(0.22, 0.61, 0.36, 1);
            border-radius: 20px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .number-section {
            background: rgba(252, 210, 15, 0.05);
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .section-title {
            font-family: 'Montserrat', sans-serif;
            color: var(--primary);
            font-size: 1.4em;
            margin-bottom: 20px;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .number-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 12px;
            min-height: 200px;
            border: 2px dashed rgba(30, 90, 168, 0.2);
            padding: 20px;
            border-radius: 15px;
            background: rgba(255, 255, 255, 0.1);
        }

        .number-button {
            aspect-ratio: 1;
            background: white;
            border: 2px solid var(--primary);
            color: var(--primary);
            border-radius: 10px;
            font-weight: bold;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 1.2em;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.08);
            min-width: 40px;
            min-height: 40px;
        }

        .number-button:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }

        .number-button.selected {
            background: var(--secondary);
            border-color: var(--secondary);
            color: white;
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(29, 138, 63, 0.4);
        }

                 .number-button.donated {
             background: #bdc3c7;
             color: white;
             cursor: not-allowed;
             border-color: #95a5a6;
             transform: none;
             box-shadow: none;
         }

         .selected-number-badge {
             display: inline-block;
             background: var(--accent);
             color: var(--dark);
             padding: 5px 10px;
             border-radius: 15px;
             font-weight: 600;
             margin: 2px;
             font-size: 0.9em;
             box-shadow: 0 2px 4px rgba(0,0,0,0.1);
         }

         .selected-numbers {
             margin: 15px 0;
             min-height: 30px;
             display: flex;
             flex-wrap: wrap;
             justify-content: center;
             align-items: center;
             gap: 5px;
         }

        .donation-summary {
            background: rgba(30, 90, 168, 0.05);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 30px 0;
            border: 2px dashed var(--accent);
        }

        .donation-summary h3 {
            font-family: 'Montserrat', sans-serif;
            color: var(--primary);
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .donation-summary .amount {
            font-size: 2.2em;
            font-weight: 800;
            color: var(--secondary);
            margin: 10px 0;
        }

        .payment-section {
            background: rgba(252, 210, 15, 0.05);
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .payment-btn {
            padding: 20px 15px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            text-align: center;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
        }

        .payment-btn i {
            font-size: 2.5em;
        }

        .payment-btn .label {
            font-size: 1.1em;
        }

        .payment-btn .details {
            font-size: 0.9em;
            color: var(--text-light);
            margin-top: 5px;
        }

        .payment-btn:hover {
            background: #f8f9fa;
            border-color: var(--primary);
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.12);
        }

        .payment-btn.selected {
            background: rgba(29, 138, 63, 0.1);
            color: var(--secondary);
            border-color: var(--secondary);
            box-shadow: 0 0 15px rgba(29, 138, 63, 0.2);
        }

        .donate-btn {
            padding: 20px;
            width: 100%;
            font-size: 1.3em;
            font-weight: bold;
            background: linear-gradient(45deg, var(--secondary), #2ecc71);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            box-shadow: 0 6px 15px rgba(29, 138, 63, 0.4);
            margin-top: 30px;
        }

        .donate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(29, 138, 63, 0.5);
            opacity: 0.95;
        }

        .donate-btn:disabled {
            background: #aaa;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
.modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 60%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            text-align: center;
        }



        .close-btn {
            position: absolute;
            top: 20px;
            right: 25px;
            font-size: 28px;
            color: #aaa;
            cursor: pointer;
            transition: var(--transition);
        }

        .close-btn:hover {
            color: var(--danger);
            transform: rotate(90deg);
        }

        .payment-instructions {
            background: rgba(252, 210, 15, 0.1);
            padding: 25px;
            border-radius: 15px;
            margin: 25px 0;
            border-left: 4px solid var(--accent);
            text-align: left;
        }

        .payment-instructions p {
            margin: 10px 0;
            line-height: 1.6;
        }

        .donor-form {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 15px;
            margin: 30px 0;
            text-align: left;
        }

        .donor-form h4 {
            margin-bottom: 20px;
            text-align: center;
            color: var(--primary);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--primary);
        }

        .form-group input, .form-group textarea {
            width: 100%;
            padding: 14px;
            border: 1px solid #ddd;
            border-radius: 10px;
            font-size: 1em;
        }

        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }

        .confirm-btn {
            padding: 16px 35px;
            background: var(--secondary);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            cursor: pointer;
            margin-top: 25px;
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 30px auto 0;
            transition: var(--transition);
        }

        .confirm-btn:hover {
            background: #27ae60;
            transform: translateY(-3px);
        }

        .amount-display {
            background: rgba(29, 138, 63, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin: 20px 0;
            border: 2px solid var(--secondary);
        }

        .amount-display h3 {
            color: var(--primary);
            margin-bottom: 10px;
        }

        .payment-method-selection {
            margin: 25px 0;
        }

        .payment-method-selection h4 {
            color: var(--primary);
            margin-bottom: 15px;
            text-align: center;
        }

        .payment-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .payment-option {
            padding: 15px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .payment-option:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .payment-option.selected {
            background: rgba(29, 138, 63, 0.1);
            border-color: var(--secondary);
            color: var(--secondary);
        }

        .payment-option i {
            font-size: 2em;
        }

        .footer {
            text-align: center;
            padding: 30px 0 10px;
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.9em;
        }

        .footer a {
            color: white;
            text-decoration: none;
            font-weight: 600;
        }

                 .footer a:hover {
             text-decoration: underline;
         }

         .success-banner {
             background: linear-gradient(135deg, var(--success), #2ecc71);
             color: white;
             padding: 20px;
             border-radius: 15px;
             margin-bottom: 25px;
             box-shadow: var(--shadow);
             animation: slideDown 0.5s ease-out;
         }

         @keyframes slideDown {
             from {
                 transform: translateY(-100%);
                 opacity: 0;
             }
             to {
                 transform: translateY(0);
                 opacity: 1;
             }
         }

         .success-content {
             display: flex;
             align-items: center;
             gap: 20px;
         }

         .success-content i {
             font-size: 2.5em;
             color: rgba(255, 255, 255, 0.9);
         }

         .success-text {
             flex: 1;
         }

         .success-text h3 {
             font-family: 'Montserrat', sans-serif;
             font-size: 1.4em;
             margin-bottom: 8px;
             font-weight: 700;
         }

         .success-text p {
             font-size: 1.1em;
             opacity: 0.95;
             line-height: 1.5;
         }

         .close-success {
             background: rgba(255, 255, 255, 0.2);
             border: none;
             color: white;
             padding: 10px;
             border-radius: 50%;
             cursor: pointer;
             transition: var(--transition);
             width: 40px;
             height: 40px;
             display: flex;
             align-items: center;
             justify-content: center;
         }

         .close-success:hover {
             background: rgba(255, 255, 255, 0.3);
             transform: scale(1.1);
         }

        @media (max-width: 900px) {
            .number-grid {
                grid-template-columns: repeat(6, 1fr);
            }
            
            .payment-methods {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 90%;
                padding: 30px 20px;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.2em;
            }
            
            .header h2 {
                font-size: 1.2em;
            }
            
            .number-grid {
                grid-template-columns: repeat(5, 1fr);
            }
            
            .progress-info {
                flex-direction: column;
                gap: 10px;
                align-items: center;
            }
            
            .form-row {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }

        @media (max-width: 576px) {
            .container {
                padding: 20px 15px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 1.8em;
            }
            
            .number-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .mission-info, .admin-panel, .fundraiser-card, .donation-summary, .auth-form {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-globe-africa"></i> Help Johanna Get to Tanzania</h1>
            <h2>Mission Trip to Arusha â€¢ November 20-30, 2024</h2>
            <div class="trip-dates">
                <i class="fas fa-calendar-alt"></i> 10 Days of Impactful Service
            </div>
            
            <div class="mission-info">
                <h3><i class="fas fa-bullseye"></i> Our Mission</h3>
                <p>We'll be ministering to over 107,000 children in Arusha, Tanzania and conducting projects at a local school (possibly painting classrooms, fixing desks, and other vital improvements to create a better learning environment).</p>
                
                <p><strong>Your donation helps cover:</strong></p>
                <ul>
                    <li>Round-trip flights to Tanzania</li>
                    <li>Accommodation and meals during the trip</li>
                    <li>Project supplies and materials</li>
                    <li>Educational resources for the children</li>
                    <li>Transportation within Tanzania</li>
                </ul>
                
                <div class="mission-highlight">
                    <p><strong>"Pick A Number"</strong> to represent the donation amount that you would like to give (you can choose multiple numbers to get the sum of your choice). Afterwards, scroll to the bottom to select payment option and press "Next".</p>
                </div>
            </div>
        </div>

                 <!-- Success Message Banner -->
         <div class="success-banner" id="successBanner" style="display: none;">
             <div class="success-content">
                 <i class="fas fa-heart"></i>
                 <div class="success-text">
                     <h3>Thank You for Your Donation!</h3>
                     <p>Your generous contribution of <strong id="successAmount">$0</strong> will help Johanna make a difference in Tanzania. Every donation brings us closer to our goal!</p>
                 </div>
                 <button class="close-success" onclick="closeSuccessBanner()">
                     <i class="fas fa-times"></i>
                 </button>
             </div>
         </div>

         <div class="fundraiser-card" id="fundraiserCard">
             <div class="fundraiser-header">
                 <div class="fundraiser-name">Johanna</div>
                 <div class="fundraiser-bio" id="bioDisplay">I'm passionate about serving others and making a difference in the lives of children. This Tanzania mission is close to my heart!</div>
             </div>
            
            <div class="progress-section">
                <div class="progress-info">
                    <div class="progress-text" id="progressText">$0 / $3,500</div>
                    <div class="progress-percentage" id="progressPercentage">0% to goal</div>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
            </div>
            
            <!-- Number Grid Section -->
            <div class="number-section">
                <h3 class="section-title"><i class="fas fa-hashtag"></i> Pick Your Number(s)</h3>
                <div class="number-grid" id="numberGrid"></div>
            </div>
            
                         <div class="donation-summary" id="donationSummary">
                 <h3>Your Selected Numbers</h3>
                 <div class="selected-numbers" id="selectedNumbersDisplay">No numbers selected</div>
                 <div class="amount">$0</div>
                 <p>Click "Continue to Payment" below to complete your donation</p>
             </div>
            
            <div class="payment-section">
                <h3 class="section-title"><i class="fas fa-credit-card"></i> Ready to Donate?</h3>
                <p style="text-align: center; color: var(--text-light); margin: 20px 0;">
                    Click "Next" below to complete your donation and choose your payment method.
                </p>
            </div>
            
                         <button class="donate-btn" onclick="processDonation()" disabled id="donateBtn">
                 <i class="fas fa-credit-card"></i> Continue to Payment
             </button>
        </div>
        
        <div class="footer">
            <p>Thank you for supporting Johanna's mission trip to Tanzania! Every donation makes a difference.</p>
            <p>Â© 2024 Johanna's Mission Trip Fundraiser</p>
            <p style="margin-top: 10px;">
                <a href="/login.html" style="color: var(--accent); text-decoration: none; font-weight: 600;">
                    <i class="fas fa-chart-line"></i> Admin Dashboard
                </a>
            </p>
        </div>
        
  
        

    <!-- Payment Modal -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h2><i class="fas fa-donate"></i> Complete Your Donation</h2>
            
            <!-- Amount Display (Read-only) -->
            <div class="amount-display">
                <h3>Donation Amount</h3>
                <div class="amount" id="modalAmount">$0</div>
            </div>
            
            <!-- Payment Method Selection -->
            <div class="payment-method-selection">
                <h4>Choose Payment Method</h4>
                <div class="payment-options">
                    <div class="payment-option" onclick="selectModalPayment('Venmo')">
                        <i class="fab fa-vimeo-v" style="color: #3D95CE;"></i>
                        <span>Venmo</span>
                    </div>
                    <div class="payment-option" onclick="selectModalPayment('CashApp')">
                        <i class="fas fa-dollar-sign" style="color: #00C244;"></i>
                        <span>CashApp</span>
                    </div>
                    <div class="payment-option" onclick="selectModalPayment('PayPal')">
                        <i class="fab fa-paypal" style="color: #003087;"></i>
                        <span>PayPal</span>
                    </div>
                    <div class="payment-option" onclick="selectModalPayment('Zelle')">
                        <i class="fas fa-university" style="color: #6d1ed4;"></i>
                        <span>Zelle</span>
                    </div>
                </div>
            </div>
            
            <!-- Payment Instructions -->
            <div class="payment-instructions" id="paymentInstructions" style="display: none;">
                <h3 id="paymentInstructionTitle">Send $0 to Johanna</h3>
                <div id="paymentInstructionDetails"></div>
            </div>
            
            <!-- Donor Form -->
            <div class="donor-form">
                <h4><i class="fas fa-user-circle"></i> Donor Information</h4>
                <div class="form-row">
                    <div class="form-group">
                        <label for="donorName">Full Name *</label>
                        <input type="text" id="donorName" required placeholder="Your full name">
                    </div>
                    <div class="form-group">
                        <label for="donorEmail">Email *</label>
                        <input type="email" id="donorEmail" required placeholder="Your email address">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="donorPhone">Phone Number *</label>
                        <input type="tel" id="donorPhone" required placeholder="Your phone number">
                    </div>
                    <div class="form-group">
                        <label for="donorAddress">Mailing Address *</label>
                        <input type="text" id="donorAddress" required placeholder="Street Address, City, State, ZIP">
                    </div>
                </div>
            </div>
            
            <button class="confirm-btn" onclick="confirmDonation()" id="confirmBtn" disabled>
                <i class="fas fa-check-circle"></i> Submit Donation
            </button>
        </div>
    </div>

    <script>
        // Backend API Configuration
      const API_URL = "/api/donations";
        let selectedNumbers = [];
        let selectedPayment = '';
        let donations = [];
        let goal = 3500;

async function fetchDonations() {
  try {
    const res = await fetch(API_URL);
    if (!res.ok) {
      throw new Error(`HTTP error! status: ${res.status}`);
    }
    donations = await res.json();
    console.log('Fetched donations:', donations);
  } catch (error) {
    console.error('Error fetching donations:', error);
    donations = []; // Set empty array if fetch fails
  }
}

function getTakenNumbers() {
  return donations.flatMap(d => Array.isArray(d.number) ? d.number : [d.number]);
}

function generateNumberGrid() {
  const grid = document.getElementById('numberGrid');
  if (!grid) {
    console.error('Number grid element not found!');
    return;
  }
  
  grid.innerHTML = '';
  const taken = getTakenNumbers();
  
  for (let i = 1; i <= 80; i++) {
    const button = document.createElement('div');
    button.className = 'number-button';
    button.textContent = i;
    button.title = `Donate $${i}`;
    
    if (taken.includes(i)) {
      button.classList.add('donated');
      button.style.pointerEvents = 'none';
    } else if (selectedNumbers.includes(i)) {
      button.classList.add('selected');
    }
    
    button.onclick = () => selectNumber(i);
    grid.appendChild(button);
  }
  
  console.log('Number grid generated with', grid.children.length, 'buttons');
}

function selectNumber(number) {
  const taken = getTakenNumbers();
  if (taken.includes(number)) return;
  
  // Toggle selection - if already selected, remove it; if not selected, add it
  const index = selectedNumbers.indexOf(number);
  if (index > -1) {
    selectedNumbers.splice(index, 1);
  } else {
    selectedNumbers.push(number);
  }
  
  generateNumberGrid();
  updateDonationSummary();
}

function updateDonationSummary() {
  const total = selectedNumbers.reduce((sum, num) => sum + num, 0);
  
  // Update selected numbers display
  const numbersDisplay = document.getElementById('selectedNumbersDisplay');
  if (selectedNumbers.length === 0) {
    numbersDisplay.textContent = 'No numbers selected';
  } else {
    numbersDisplay.innerHTML = selectedNumbers.map(num => 
      `<span class="selected-number-badge">${num}</span>`
    ).join('');
  }
  
  // Update amount
  document.querySelector('#donationSummary .amount').textContent = `$${total}`;
  
  // Update button state
  const donateBtn = document.getElementById('donateBtn');
  if (selectedNumbers.length === 0) {
    donateBtn.disabled = true;
  } else {
    donateBtn.disabled = false;
  }
}

function updateProgress() {
  const raised = donations.reduce((sum, d) => sum + (d.amount || 0), 0);
  const percentage = Math.min((raised / goal) * 100, 100);
  document.getElementById('progressFill').style.width = `${percentage}%`;
  document.getElementById('progressText').textContent = `$${raised} / $${goal.toLocaleString()}`;
  document.getElementById('progressPercentage').textContent = `${Math.round(percentage)}% to goal`;
  if (raised >= goal) {
    document.getElementById('fundraiserCard').classList.add('completed');
    document.getElementById('numberGrid').style.display = 'none';
    document.querySelector('.payment-methods').style.display = 'none';
    document.getElementById('donateBtn').style.display = 'none';
    document.getElementById('donationSummary').innerHTML = '<div class="success-message"><i class="fas fa-check-circle"></i> ðŸŽ‰ Goal Reached! Thank you for helping Johanna get to Tanzania!</div>';
  }
}



function processDonation() {
  if (selectedNumbers.length === 0) return;
  const total = selectedNumbers.reduce((sum, num) => sum + num, 0);
  
  // Store selected numbers in sessionStorage for the donation page
  sessionStorage.setItem('selectedNumbers', JSON.stringify(selectedNumbers));
  sessionStorage.setItem('donationAmount', total);
  
  // Redirect to donation page
  window.location.href = '/donate';
}

function showPaymentModal(amount) {
  const modal = document.getElementById('paymentModal');
  
  // Update the modal content with the selected amount
  document.getElementById('modalAmount').textContent = `$${amount}`;
  
  // Reset payment method selection
  selectedPayment = '';
  document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('selected'));
  document.getElementById('paymentInstructions').style.display = 'none';
  document.getElementById('confirmBtn').disabled = true;
  
  modal.style.display = 'flex';
}

function closeModal() {
  document.getElementById('paymentModal').style.display = 'none';
}

function selectModalPayment(method) {
  selectedPayment = method;
  document.querySelectorAll('.payment-option').forEach(opt => opt.classList.remove('selected'));
  event.target.closest('.payment-option').classList.add('selected');
  
  const amount = selectedNumbers.reduce((sum, num) => sum + num, 0);
  showPaymentInstructions(method, amount);
  checkFormCompletion();
}

function showPaymentInstructions(method, amount) {
  const instructions = document.getElementById('paymentInstructions');
  const title = document.getElementById('paymentInstructionTitle');
  const details = document.getElementById('paymentInstructionDetails');
  
  const paymentMethods = {
    'Venmo': { 
      handle: '@Johanna-Jones-23', 
      instruction: `Please send $${amount} now via Venmo to @Johanna-Jones-23` 
    },
    'CashApp': { 
      handle: '$JohannaAdoni', 
      instruction: `Please send $${amount} now via CashApp to $JohannaAdoni` 
    },
    'PayPal': { 
      handle: 'paypal.me/YourName', 
      instruction: `Please send $${amount} now via PayPal to paypal.me/YourName` 
    },
    'Zelle': { 
      handle: '512-585-4106', 
      instruction: `Please send $${amount} now via Zelle to 512-585-4106` 
    }
  };
  
  const payment = paymentMethods[method];
  title.innerHTML = `Send $${amount} to Johanna`;
  details.innerHTML = `
    <p><strong><i class="fas fa-info-circle"></i> ${payment.instruction}</strong></p>
    <p><strong><i class="fas fa-sticky-note"></i> Memo:</strong> Tanzania Mission Trip</p>
  `;
  
  instructions.style.display = 'block';
}

function checkFormCompletion() {
  const donorName = document.getElementById('donorName').value;
  const donorEmail = document.getElementById('donorEmail').value;
  const donorPhone = document.getElementById('donorPhone').value;
  const donorAddress = document.getElementById('donorAddress').value;
  
  const isFormComplete = donorName && donorEmail && donorPhone && donorAddress && selectedPayment;
  document.getElementById('confirmBtn').disabled = !isFormComplete;
}

async function confirmDonation() {
  const donorName = document.getElementById('donorName').value;
  const donorEmail = document.getElementById('donorEmail').value;
  const donorPhone = document.getElementById('donorPhone').value;
  const donorAddress = document.getElementById('donorAddress').value;

  if (!donorName || !donorEmail || !donorPhone || !donorAddress || !selectedPayment) {
    alert('Please fill out all fields and select a payment method.');
    return;
  }

  const amount = selectedNumbers.reduce((sum, num) => sum + num, 0);

  // Submit to backend
  const res = await fetch(API_URL, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      number: selectedNumbers.length === 1 ? selectedNumbers[0] : selectedNumbers,
      name: donorName,
      email: donorEmail,
      phone: donorPhone,
      address: donorAddress,
      amount,
      paymentMethod: selectedPayment
    })
  });
  const result = await res.json();
  if (result.success) {
    alert('Thank you for your donation! Johanna appreciates your support for her mission trip.');
    selectedNumbers = [];
    selectedPayment = '';
    document.getElementById('donorName').value = '';
    document.getElementById('donorEmail').value = '';
    document.getElementById('donorPhone').value = '';
    document.getElementById('donorAddress').value = '';
    closeModal();
    await loadAndRender();
  } else {
    alert('Error: ' + result.error);
  }
}

async function loadAndRender() {
  try {
    await fetchDonations();
    generateNumberGrid();
    updateProgress();
    updateDonationSummary();
    console.log('Page loaded successfully');
  } catch (error) {
    console.error('Error loading page:', error);
  }
}

 function showSuccessBanner() {
   const successBanner = document.getElementById('successBanner');
   const successAmount = document.getElementById('successAmount');
   const amount = sessionStorage.getItem('donationAmount');
   
   if (amount) {
     successAmount.textContent = `$${amount}`;
     successBanner.style.display = 'block';
     
     // Auto-hide after 10 seconds
     setTimeout(() => {
       closeSuccessBanner();
     }, 10000);
   }
 }

 function closeSuccessBanner() {
   const successBanner = document.getElementById('successBanner');
   successBanner.style.display = 'none';
   
   // Clear session storage
   sessionStorage.removeItem('donationSuccess');
   sessionStorage.removeItem('donationAmount');
   sessionStorage.removeItem('donorName');
 }

 document.addEventListener('DOMContentLoaded', () => {
   console.log('DOM loaded, initializing...');
   loadAndRender();
   document.getElementById('donateBtn').onclick = processDonation;
   
   // Add form field listeners for completion checking
   document.getElementById('donorName').addEventListener('input', checkFormCompletion);
   document.getElementById('donorEmail').addEventListener('input', checkFormCompletion);
   document.getElementById('donorPhone').addEventListener('input', checkFormCompletion);
   document.getElementById('donorAddress').addEventListener('input', checkFormCompletion);
   
   // Check for success message
   const donationSuccess = sessionStorage.getItem('donationSuccess');
   if (donationSuccess === 'true') {
     showSuccessBanner();
   }
 });
</script>
</body>
</html>


